var Jobj,Arrs=[],before_X=0,plus_count=4;function showDetail(t,e,a){document.getElementById(t).style.display="",document.getElementById(t).style.left=(window.innerWidth-e)/2+"px",document.getElementById(t).style.top=(window.innerHeight-a)/2+"px"}function MsgAlert(){var t=this.getElementsByClassName("node-name")[0].innerText.split(" ")[0].split("#")[1];if(""!=t&&null!=t){t=parseInt(t);var e=Jobj.data[t-1],a="";switch(e.status){case 0:a="(사망)";break;case 2:a="(완치)"}document.getElementById("title_").innerText=e.num+"번 확진자 "+a;var r="",s="";switch(e.country){case"cn":s="중국";break;case"kr":s="한국"}r+="<h3 class='d'>"+e.from+" <span>"+e.age+(isNaN(e.age)?"?세":"세")+" "+s+" "+("w"==e.sex?"여성":"남성")+"</span></h3>",r+="<p>접촉자 "+(void 0!==e.contact?e.contact+"명":"확인중")+", "+(void 0!==Arrs[t+plus_count].children?Arrs[t+plus_count].children.length+"":"0")+"명에게 전파</p>",r+="<p>격리 병원 : "+e.hospital+"</p>",r+="<p>확진 날짜 : "+e.confirmDate+"</p>",r+=2==e.status?"<p>퇴원 날짜 : "+e.dischargeDate+"</p>":"",document.getElementById("info_").innerHTML=r,showDetail("alertMsg",324,204)}}Arrs.push(JSON.parse('{"text": {"cn": "2019-nCov","name":""},"HTMLclass":"title"}')),Arrs.push(JSON.parse('{"text": {"country":"중국","name":""}}')),Arrs[Arrs.length-1].parent=Arrs[0],Arrs.push(JSON.parse('{"text": {"country":"일본","name":""}}')),Arrs[Arrs.length-1].parent=Arrs[0],Arrs.push(JSON.parse('{"text": {"country":"태국","name":""}}')),Arrs[Arrs.length-1].parent=Arrs[0],Arrs.push(JSON.parse('{"text": {"country":"싱가포르","name":""}}')),Arrs[Arrs.length-1].parent=Arrs[0],function(){var t=new XMLHttpRequest;t.open("GET","./data.json",!0),t.onreadystatechange=function(){if(4==t.readyState)if(200==t.status){Jobj=JSON.parse(t.responseText),document.getElementById("update").innerText="최근 업데이트 : "+Jobj.info.update;for(var e=0,a=0,r=0,s=0,n=[],o=JSON.parse('{"kr":0,"cn":0,"default":0}'),l=JSON.parse('{"0":0,"1":0,"2":0}'),p=100,c=0,d=0;d<Jobj.data.length;d++){switch(Arrs.push(JSON.parse("{}")),Arrs[Arrs.length-1].text=JSON.parse('{"name": "#'+Jobj.data[d].num+'"}'),Arrs[Arrs.length-1].image="./"+Jobj.data[d].sex+".png",Jobj.data[d].parent){case 0:switch(Jobj.data[d].from){case"일본 방문":Arrs[Arrs.length-1].parent=Arrs[2];break;case"태국 방문":Arrs[Arrs.length-1].parent=Arrs[3];break;case"싱가포르 방문":Arrs[Arrs.length-1].parent=Arrs[4];break;default:Arrs[Arrs.length-1].parent=Arrs[1]}break;default:Arrs[Arrs.length-1].parent=Arrs[Jobj.data[d].parent+plus_count]}switch(null==n[Jobj.data[d].hospital]&&(n.push({name:Jobj.data[d].hospital,cou:0,cou2:0,cou0:0}),n[Jobj.data[d].hospital]=n.length-1),1==Jobj.data[d].status?n[n[Jobj.data[d].hospital]].cou++:2==Jobj.data[d].status?n[n[Jobj.data[d].hospital]].cou2++:0==Jobj.data[d].status&&n[n[Jobj.data[d].hospital]].cou0++,Jobj.data[d].wuhan&&(r++,"우한 교민"==Jobj.data[d].from&&s++),Arrs[Arrs.length-1].HTMLclass="status_"+Jobj.data[d].status,l[Jobj.data[d].status]++,e+=Jobj.data[d].age,p=p>Jobj.data[d].age?Jobj.data[d].age:p,c=c<Jobj.data[d].age?Jobj.data[d].age:c,"m"==Jobj.data[d].sex&&a++,Jobj.data[d].country){case"kr":o.kr++;break;case"cn":o.cn++;break;default:o.default++}}Arrs.push(JSON.parse('{"container": "#nCov","nodeAlign": "BOTTOM","connectors": {"type": "step"},"node": {"HTMLclass": "node1","collapsable": true}}')),new Treant(Arrs),before_X=window.innerWidth;var u=document.getElementsByClassName("node");for(d=0;d<u.length;d++)u[d].addEventListener("click",MsgAlert);var i="";n.sort(function(t,e){return parseInt(t.cou)>parseInt(e.cou)?-1:parseInt(t.cou)<parseInt(e.cou)?1:0}),i+="<p>총 확진자 수 : <b>"+Jobj.data.length+"명</b> (우한 방문자 "+r+"명)</p>",i+="<p>격리중 : <b>"+l[1]+"명</b>, 완치 : "+l[2]+"명, 사망자 : "+l[0]+"명</p>",i+="<p>유증상자 : 조사 중 <b>"+Jobj.info.Symptom_quarantine+"명</b>, 격리해제 "+Jobj.info.Symptom_release+"명",i+="<p>평균 연령 : "+parseFloat((e/Jobj.data.length).toFixed(1))+"세 ("+p+"~"+c+"세)</p>";var h=a>Jobj.data.length-a;i+="<p>성비 : 남성 "+a+"명 : 여성 "+(Jobj.data.length-a)+"명 "+(h?"("+parseFloat((a/(Jobj.data.length-a)).toFixed(1))+" : 1)":"(1 : "+parseFloat(((Jobj.data.length-a)/a).toFixed(1))+")")+"</p>",i+="<p>국적 : 한국인 "+o.kr+"명, 중국인 "+o.cn+"명</p>",i+="<p>우한 교민 : <b>"+s+"명</b> 확진</p>",i+="<br><h4>격리 병원 통계</h4><ul class='sitelist'>";var b="";for(d=0;d<n.length;d++)"확인중"==n[d].name?b="<li>"+n[d].name+" : "+n[d].cou+"명</li>":0!=n[d].cou&&(i+="<li>"+n[d].name+" : "+n[d].cou+"명</li>");i+=b+"</ul>",i+="<br><h4>완치 병원 통계</h4><ul class='sitelist'>",n.sort(function(t,e){return parseInt(t.cou2)>parseInt(e.cou2)?-1:parseInt(t.cou2)<parseInt(e.cou2)?1:0});for(d=0;d<n.length;d++)0!=n[d].cou2&&(i+="<li>"+n[d].name+" : "+n[d].cou2+"명 퇴원</li>");i+="</ul>",document.getElementById("stats").innerHTML=i}else alert("데이터 로딩에 실패하였습니다.")},t.send()}(),window.addEventListener("resize",function(){if(before_X!=window.innerWidth){Treant(Arrs);for(var t=document.getElementsByClassName("node"),e=0;e<t.length;e++)t[e].addEventListener("click",MsgAlert)}});
