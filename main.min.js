var Jobj,Arrs=[],before_X=0;function showDetail(e,t,a){document.getElementById(e).style.display="",document.getElementById(e).style.left=(window.innerWidth-t)/2+"px",document.getElementById(e).style.top=(window.innerHeight-a)/2+"px"}function MsgAlert(){var e=this.getElementsByClassName("node-name")[0].innerText.split(" ")[0];if(""!=e){var t=Jobj.data[e-1],a="";switch(t.status){case 0:a="(사망)";break;case 2:a="(완치)"}document.getElementById("title_").innerText=t.num+"번 확진자 "+a;var n="",r="";switch(t.country){case"cn":r="중국";break;case"kr":r="한국"}n+="<h3 class='d'>"+t.from+" <span>"+t.age+(isNaN(t.age)?"?세":"세")+" "+r+" "+("w"==t.sex?"여성":"남성")+"</span></h3>",n+="<p>접촉자 "+(void 0!==t.contact?t.contact+"명":"확인중")+", "+(void 0!==Arrs[e].children?Arrs[e].children.length+"":"0")+"명에게 전파</p>",n+="<p>격리 병원 : "+t.hospital+"</p>",n+="<p>확진 날짜 : "+t.confirmDate+"</p>",document.getElementById("info_").innerHTML=n,showDetail("alertMsg",324,204)}}Arrs.push(JSON.parse('{"text": {"cn": "2019-nCov","name":""},"HTMLclass":"title"}')),function(){var e=new XMLHttpRequest;e.open("GET","./data.json",!0),e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status){Jobj=JSON.parse(e.responseText),document.getElementById("update").innerText="최근 업데이트 : "+Jobj.info.update;for(var t=0,a=0,n=0,r=0,s=[],o=JSON.parse('{"kr":0,"cn":0,"default":0}'),d=JSON.parse('{"0":0,"1":0,"2":0}'),l=100,i=0,p=0;p<Jobj.data.length;p++)switch(Arrs.push(JSON.parse("{}")),Arrs[Arrs.length-1].text=JSON.parse('{"name": "'+Jobj.data[p].num+" ("+Jobj.data[p].age+'세)"}'),Arrs[Arrs.length-1].image="./"+Jobj.data[p].sex+".png",Arrs[Arrs.length-1].parent=Arrs[Jobj.data[p].parent],null==s[Jobj.data[p].hospital]?(s.push({name:Jobj.data[p].hospital,cou:1}),s[Jobj.data[p].hospital]=s.length-1):s[s[Jobj.data[p].hospital]].cou++,Jobj.data[p].wuhan&&(n++,"우한 교민"==Jobj.data[p].from&&r++),Arrs[Arrs.length-1].HTMLclass="status_"+Jobj.data[p].status,d[Jobj.data[p].status]++,t+=Jobj.data[p].age,l=l>Jobj.data[p].age?Jobj.data[p].age:l,i=i<Jobj.data[p].age?Jobj.data[p].age:i,"m"==Jobj.data[p].sex&&a++,Jobj.data[p].country){case"kr":o.kr++;break;case"cn":o.cn++;break;default:o.default++}Arrs.push(JSON.parse('{"container": "#nCov","nodeAlign": "BOTTOM","connectors": {"type": "step"},"node": {"HTMLclass": "node1"}}')),new Treant(Arrs),before_X=window.innerWidth;var c=document.getElementsByClassName("node");for(p=0;p<c.length;p++)c[p].addEventListener("click",MsgAlert);var b="";s.sort(function(e,t){return parseInt(e.cou)>parseInt(t.cou)?-1:parseInt(e.cou)<parseInt(t.cou)?1:0}),b+="<p>총 확진자 수 : <b>"+Jobj.data.length+"명</b> (우한 방문자 "+n+"명)</p>",b+="<p>격리중 : <b>"+d[1]+"명</b>, 완치 : "+d[2]+"명, 사망자 : "+d[0]+"명</p>",b+="<p>유증상자 : 조사 중 <b>"+Jobj.info.Symptom_quarantine+"명</b>, 격리해제 "+Jobj.info.Symptom_release+"명",b+="<p>평균 연령 : "+parseFloat((t/Jobj.data.length).toFixed(1))+"세 ("+l+"~"+i+"세)</p>";var u=a>Jobj.data.length-a;b+="<p>성비 : 남성 "+a+"명 : 여성 "+(Jobj.data.length-a)+"명 "+(u?"("+parseFloat((a/(Jobj.data.length-a)).toFixed(1))+" : 1)":"(1 : "+parseFloat(((Jobj.data.length-a)/a).toFixed(1))+")")+"</p>",b+="<p>국적 : 한국인 "+o.kr+"명, 중국인 "+o.cn+"명</p>",b+="<p>우한 교민 : <b>"+r+"명</b> 확진</p>",b+="<br><h4>격리 병원 통계</h4><ul class='sitelist'>";var g="";for(p=0;p<s.length;p++)"확인중"==s[p].name?g="<li>"+s[p].name+" : "+s[p].cou+"명</li>":b+="<li>"+s[p].name+" : "+s[p].cou+"명</li>";b+=g+"</ul>",document.getElementById("stats").innerHTML=b}else alert("데이터 로딩에 실패하였습니다.")},e.send()}(),window.addEventListener("resize",function(){if(before_X!=window.innerWidth){Treant(Arrs);for(var e=document.getElementsByClassName("node"),t=0;t<e.length;t++)e[t].addEventListener("click",MsgAlert)}});